library(MASS)

Wien = function(num, delta){
  rn<-rnorm(n=num, m=0, sd=1)
  c(0, cumsum(rn))*sqrt(delta)}

N = 1000
t0 = 10
delta = 0.1
b = -1
c = 2
x0 = 2
t = seq(0, t0, by = delta)                    
n<- length(t)
X2 <- data.frame('1' = double(), '5' = double(), '10' = double())
X1 <- X2                                    #?????????? ??????????? ?????
k0<-as.integer(c(1, 5, 10)/delta) 

for(i in 1:N){
  wien<- Wien(n-1, delta)

  w1<-c(x0)
  w2<-c(x0)
  intl = 0
  for(k in 1:(n-1)){
    w1<-c(w1, w1[k] + b*delta +c*w1[k]*(wien[k+1]-wien[k]))
    intl = intl + delta*exp(2*(-t[k+1]+wien[k+1]))
    w2=c(w2, exp(2*(wien[k+1]-t[k+1]))*(x0 + intl))
  }
  X1[i,1:3]<-w1[k0]                       #???????? ? ?????? ?? ??????? ??????
  X2[i,1:3]= w2[k0]
}

for(k in 1:3){ #???????????? ??????????????????? ??????????
  print(sqrt(sum((X1[,k]-X2[,k])^2)/N))
}
