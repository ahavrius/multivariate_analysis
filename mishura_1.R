library(MASS)

Wien = function(num, delta){
  rn<-rnorm(n=num, m=0, sd=1)
  c(0, cumsum(rn))*sqrt(delta)}

x0 = 4
t0 = 1
delta = 0.01
a = function(t, x) exp(2*t)*log(1 + x*x)
b = function(t, x) 4*sin(x)*sin(x)*cos(t)*cos(t)
t = seq(0, t0, by = delta)                    
X<-data.frame(time = t)
n<-length(t)

for(i in 1:10){
  w<-c(x0)
  #z<-rnorm(n-1)
  z = Wien(n-1)
  for(k in 1:(n-1))
    w<-c(w, w[k] + a(t[k],w[k])*delta + b(t[k],w[k])*sqrt(delta)*(z[k+1]-z[k]))
  X[i+1]<-w
} #???????????????????? 10 ???????????????????? ?????????????? ????????????
cl<-rainbow(10) #?????????????? ?????????????? ???????????????????? ??????????????
colnames(X)<-c("times", 1:10)
matplot(t, X[2:11], col=c(2:11), type = "l", main = "Euler estimation", xlab = "delta = 0.01")


x =  matrix(nrow=10, ncol=n)
for(i in 1:10){
  x[i, 1]<-x0
  w = Wien(n, delta)
  for(k in 1:(n-1))
    x[i, k+1]<- x[i, k] + a(t[k],x[i, k])*delta + b(t[k],x[i, k])*sqrt(delta)*(w[k+1]-w[k])
} #???????????????????? 10 ???????????????????? ?????????????? ????????????

matplot(t, x[1:10], col=c(2:11), type = "l", main = "Euler estimation", xlab = "delta = 0.01")


